<%- include('../partials/header', { title: 'Afegir Incidència' }) %>
<% if (messages.success && messages.success.length > 0) { %>
  <div id="flash-message" class="alert alert-success">
    <%= messages.success[0] %>
  </div>
<% } %>

<% if (messages.error && messages.error.length > 0) { %>
  <div id="flash-message" class="alert alert-danger">
    <%= messages.error[0] %>
  </div>
<% } %>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow rounded-4">
        <div class="card-body p-4">
          <h2 class="card-title text-center mb-4">
            <i class="bi bi-plus-circle-fill text-success me-2"></i>
            Nova Incidència
          </h2>

          <form action="/incidencies/create" method="POST">
            <div class="mb-3">
              <label for="descripcio" class="form-label fw-semibold">Descripció</label>
              <input
                type="text"
                id="descripcio"
                name="descripcio"
                class="form-control form-control-lg"
                placeholder="Introdueix la descripció de la incidència"
                required
              />
            </div>

            <!-- Departament -->
<div class="mb-4">
  <label for="id_departament" class="form-label fw-semibold">Departament</label>
  <select name="id_departament" id="id_departament" class="form-select form-select-lg" required>
    <option disabled selected value="">-- Selecciona un departament --</option>
    <% departaments.forEach(departament => { %>
      <option value="<%= departament.id %>"><%= departament.nom_dpt %></option>
    <% }) %>
  </select>
</div>

<!-- Tipus -->
<div class="mb-4">
  <label for="id_tipus" class="form-label fw-semibold">Tipus</label>
  <select name="id_tipus" id="id_tipus" class="form-select form-select-lg" required>
    <option disabled selected value="">-- Selecciona un tipus --</option>
    <% tipus_const.forEach(tipusItem => { %>
      <option value="<%= tipusItem.id %>"><%= tipusItem.nom_tipus %></option>
    <% }) %>
  </select>
</div>

            <div class="d-flex justify-content-between">
              <button type="submit" class="btn btn-success btn-lg w-50 me-2">
                <i class="bi bi-check-circle me-1"></i> Crear
              </button>
              <a href="/" class="btn btn-outline-secondary btn-lg w-50 ms-2">
                <i class="bi bi-x-circle me-1"></i> Cancel·lar
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>



<%- include('../partials/footer') %>
