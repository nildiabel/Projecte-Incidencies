<!-- header.ejs -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title><%= title %></title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    crossorigin="anonymous"
  />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

</head>
<body class="bg-light">

  <!-- Barra de navegación -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
      <a class="navbar-brand" href="/" id="projecte-link"><img style="height: 50px; border-radius: 50px;" src="/images/image-removebg-preview.png" alt="logoincidencies"> Projecte Incidencies</a>
      
    </div>
  </nav>

  <!-- Contenedor para mostrar el formulario de contraseña (oculto inicialmente) -->
  <div id="password-prompt" class="container py-5" style="display: none;">
    <div class="row justify-content-center">
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card shadow-lg rounded-4 border-0">
          <div class="card-body p-4">
            <h4 class="card-title text-center mb-4">
              <i class="bi bi-lock-fill me-2 text-primary"></i>Accés Protegit
            </h4>
  
            <div class="input-group mb-3">
              <span class="input-group-text">
                <i class="bi bi-key-fill"></i>
              </span>
              <input
                type="password"
                id="password"
                class="form-control form-control-lg"
                placeholder="Introdueix la contrasenya"
                required
              />
            </div>
  
            <button
              class="btn btn-success btn-lg w-100"
              onclick="checkPassword()"
            >
              <i class="bi bi-unlock-fill me-1"></i> Accedir
            </button>
  
            <p id="error-message" class="text-danger mt-3 text-center fw-semibold" style="display: none;">
              <i class="bi bi-exclamation-triangle-fill me-1"></i> Contrasenya incorrecta. Torna-ho a intentar.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    const correctPassword = "12345";

    // Verificar si ya se ha validado la contraseña
    if (sessionStorage.getItem("accessGranted") === "true") {
      document.getElementById("incidencies-link").style.pointerEvents = "none";
      document.getElementById("projecte-link").style.pointerEvents = "none"; // Desactivar el enlace
    }

    function showPasswordPrompt() {
      document.getElementById("password-prompt").style.display = "block";
      document.getElementById("main-content").style.display = "none";
      document.getElementById("incidencies-link").style.pointerEvents = "none";
      document.getElementById("projecte-link").style.pointerEvents = "none"; // Desactivar el enlace
    }

    function checkPassword() {
      const enteredPassword = document.getElementById("password").value;
      if (enteredPassword === correctPassword) {
        sessionStorage.setItem("accessGranted", "true"); // Guardar en sessionStorage que el acceso fue concedido
        window.location.href = "/incidencies";
      } else {
        document.getElementById("error-message").style.display = "block";
      }
    }
  </script>
</body>
</html>
